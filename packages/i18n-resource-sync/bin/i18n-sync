#!/usr/bin/env node

const program = require('commander');
const fileExist = require('../lib/uitls/fileExit').default;
program
  .option('-c, --config [config]', '拉取语言包配置文件，默认为i18n.sync.json')
  .option('--type [type]', '指定项目类型')
  .option('--clean', '清除dest目录')
  .option('--page [page]', '用来指定Mach Pro中的页面name')
  .parse(process.argv);

const { config, type, clean, page } = program.opts();

const cwd = process.cwd();

const path = require('path');
const isMachPro = () => {
  if (type === 'mach') return true;
  if (type === 'web') return false;
  const machConfigPath = path.resolve(cwd, './mach.config.js');
  return fileExist(machConfigPath);
};

if (isMachPro()) {
  const talosEnv = process.env;
  const pageName = talosEnv && talosEnv.bundleName ? talosEnv.bundleName : page;
  require('../lib/mach/index').getLanguagePackage(pageName || '');
  return;
}
require('../lib/web/index').getLanguagePackage({
  config,
  clean,
});
